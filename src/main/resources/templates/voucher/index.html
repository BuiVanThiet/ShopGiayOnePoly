<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{Home/home_manege}" xmlns:form="http://www.thymeleaf.org">

<head>
    <title>Voucher</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
</head>
<body>
<div layout:fragment="content">
    <section>
        <div class="bd-gutter mt-5 my-md-4 bd-layout">
            <div class="text-center">
                <p class="fs-3 mt-2">QUẢN LÝ PHIẾU GIẢM GIÁ</p>
            </div>
<!--            <div th:if="${mes != null}" class="custom-toast custom-toast-show" role="alert" aria-live="assertive"-->
<!--                 aria-atomic="true"-->
<!--                 style="position: absolute; top: 100px; right: 20px;">-->
<!--                <div class="custom-toast-header" style="background-color:#04812d">-->
<!--                    <i class="bi bi-check-circle me-2" style="font-size: 1.5rem; color: #ffffff;"></i>-->
<!--                    <strong class="me-auto fw-normal" style="color: white;">Thông báo</strong>-->
<!--                    <button type="button" class="custom-btn-close" data-bs-dismiss="custom-toast"-->
<!--                            aria-label="Close"></button>-->
<!--                </div>-->
<!--                <div class="custom-toast-body">-->
<!--                    <span th:text="${mes}"></span>-->
<!--                </div>-->
<!--            </div>-->
            <div class="row" style="margin-top: 50px">
                <div class="col-12">
                    <button type="button" class="btn btn-outline-success col-1 mb-3" data-bs-toggle="modal" data-bs-target="#addVoucherNewModal">Thêm mới</button>
                    <!-- Modal -->
                    <div class="modal fade" id="addVoucherNewModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addVoucherNewModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered  modal-xl">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="addVoucherNewModalLabel">Thêm mới</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="mb-3">
                                                <label class="form-label">Mã phiếu giảm giá</label>
                                                <input type="text" class="form-control" id="codeVoucher">
                                                <span class="text-danger" id="codeVoucherError"></span>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="mb-3">
                                                <label class="form-label">Tên phiếu giảm giá</label>
                                                <input type="text" class="form-control" id="nameVoucher">
                                                <span class="text-danger" id="nameVoucherError"></span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Loại giảm giá</label>
                                            <select id="discountType" class="form-select mt-2">
                                                <option value="2">Tiền mặt</option>
                                                <option value="1">%</option>
                                            </select>
                                            <span class="text-danger" id="discountTypeError"></span>
                                        </div>
                                        <div class="col-12 mb-3">
                                            <label class="form-label">Giá trị</label>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="value" min="0">
                                                <span class="input-group-text" id="discountTextDola" style="display: none">%</span>
                                                <span class="input-group-text" id="discountTextCash">₫</span>
                                            </div>
                                            <span class="text-danger" id="valueError"></span>
                                        </div>

                                        <div class="col-12 mb-3">
                                            <label class="form-label">Giá trị áp dụng</label>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="applyValue" min="0">
                                                <span class="input-group-text">₫</span>
                                            </div>
                                            <span class="text-danger" id="applyValueError"></span>
                                        </div>

                                        <div class="col-12 mb-3" id="boxOfMaxiumDiscount" style="display: none">
                                            <label class="form-label">Giảm tối đa</label>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="maxDiscount" min="0">
                                                <span class="input-group-text">₫</span>
                                            </div>
                                            <span class="text-danger" id="maxDiscountError"></span>
                                        </div>

                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Ghi chú</label>
                                            <textarea id="note" class="form-control mt-2"></textarea>
                                            <span class="text-danger" id="noteError"></span>
                                        </div>

                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Ngày bắt đầu</label>
                                            <input type="date" id="startDate"
                                                   class="form-control mt-2"/>
                                            <span class="text-danger" id="startDateError"></span>
                                        </div>

                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Ngày kết thúc</label>
                                            <input type="date" id="endDate"
                                                   class="form-control mt-2"/>
                                            <span class="text-danger" id="endDateError"></span>
                                        </div>

                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Số lượng</label>
                                            <input type="number" id="quantity"
                                                   class="form-control mt-2"/>
                                            <span class="text-danger" id="quantityError"></span>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">Trạng thái</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="statusVoucher" id="status1" value="1">
                                                <label class="form-check-label" for="status1">
                                                    Hoạt động
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="statusVoucher" id="status2" value="2" checked>
                                                <label class="form-check-label" for="status2">
                                                    Ngừng hoạt động
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-outline-success" data-bs-target="#confirmAddVoucher" data-bs-toggle="modal" id="btnOpenModalConfirmAddVoucher">Thêm</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal fade" id="confirmAddVoucher" aria-hidden="true" aria-labelledby="confirmAddVoucherLabel"  data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="confirmAddVoucherLabel">Xác nhận</h1>
                                </div>
                                <div class="modal-body">
                                    Bạn muốn tạo phiếu giảm giá này sao?
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-outline-danger" data-bs-target="#addVoucherNewModal" data-bs-toggle="modal">Không</button>
                                    <button class="btn btn-outline-primary" data-bs-dismiss="modal" aria-label="Close" onclick="addVoucherNew()">Đồng ý</button>
                                </div>
                            </div>
                        </div>
                    </div>
<!--                    danh sach da xoa-->
                    <!-- Button trigger modal -->

                    <div class="card">
                        <div class="card-header">
                            <div class="text-center">Tìm kiếm</div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <hr>
                                <form id="searchForm">
                                <div class="row">
                                        <div class="col-6 mb-3">
                                            <label class="search-label">Loại giảm giá</label>
                                            <select id="searchDiscountTypeInput" name="type"
                                                    class="form-select mt-3 search-input">
                                                <option value="">Tất cả</option>
                                                <option value="1">%</option>
                                                <option value="2" >Tiền mặt</option>
                                            </select>
                                        </div>
                                        <div class="col-6 mb-3">
                                            <label class="search-label">Trạng thái</label>
                                            <select id="searchStatusVoucher" name="type"
                                                    class="form-select mt-3 search-input">
                                                <option value="1">Hoạt động</option>
                                                <option value="2">Ngừng hoạt động</option>
                                                <option value="3">Hết hạn</option>
                                            </select>
                                        </div>
                                        <div class="col-12 mb-3">
                                            <label class="search-label">Tìm kiếm</label>
                                            <input type="text" class="form-control" id="inputSearchVoucher">
                                        </div>
                                    </div>
                                    <div class="col-12 text-center">
                                        <div class="mb-3">
                                            <button type="submit" class="btn btn-outline-primary">Tìm kiếm</button>
                                            <button type="button" class="btn btn-outline-danger" onclick="resetFormSearch()">Làm mới</button>
                                        </div>
                                    </div>
                                </form>
<!--                                <div class="col-md-12">-->
<!--                                    <form action="/voucher/search-key" method="get">-->
<!--                                        <label for="searchKeyword" class="search-label" data-target="#searchKeyword">Từ-->
<!--                                            khóa</label>-->
<!--                                        <div class="input-group d-flex" id="searchKeyword" style="display: none;">-->
<!--                                            <input type="text" class="form-control" name="key"-->
<!--                                                   placeholder="Tìm theo tên, mã giảm giá">-->
<!--                                            <button class="btn btn-light text-dark ms-1">-->
<!--                                                <i class="bi bi-search"></i> Search-->
<!--                                            </button>-->
<!--                                        </div>-->
<!--                                    </form>-->
<!--                                </div>-->
                            </div>
                        </div>
                    </div>

                    <div class="card mt-3">
                        <div class="card-body">
                            <!-- Nav Pills -->
<!--                            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">-->
<!--                                <li class="nav-item" role="presentation">-->
<!--                                    <a class="nav-link active" id="pills-active-tab" data-bs-toggle="pill"-->
<!--                                       href="#pills-active" role="tab" aria-controls="pills-active"-->
<!--                                       aria-selected="true">Hoạt Động</a>-->
<!--                                </li>-->
<!--                                <li class="nav-item" role="presentation">-->
<!--                                    <a class="nav-link" id="pills-inactive-tab" data-bs-toggle="pill"-->
<!--                                       href="#pills-inactive" role="tab" aria-controls="pills-inactive"-->
<!--                                       aria-selected="false">Ngừng Hoạt Động</a>-->
<!--                                </li>-->
<!--                                <li class="nav-item" role="presentation">-->
<!--                                    <a class="nav-link" id="pills-expired-tab" data-bs-toggle="pill"-->
<!--                                       href="#pills-expired" role="tab" aria-controls="pills-expired"-->
<!--                                       aria-selected="false">Hết Hạn</a>-->
<!--                                </li>-->
<!--                            </ul>-->

                            <!-- Tab Content -->
                            <div class="tab-content" id="pills-tabContent">
                                <!-- Table 1: Hoạt Động -->
                                <div class="tab-pane fade show active" id="pills-active" role="tabpanel"
                                     aria-labelledby="pills-active-tab">
                                    <div id="noDataVoucherContainer" style="display:none; text-align:center;">
                                        <!-- Ảnh sẽ được hiển thị ở đây nếu không có dữ liệu -->
                                    </div>
                                    <table class="table table-striped table-hover mt-3">
                                        <thead class="bg-primary text-white">
                                        <tr>
                                            <th>Mã</th>
                                            <th>Tên</th>
                                            <th>Giảm giá</th>
                                            <th>Số lượng</th>
                                            <th>Ngày bắt đầu</th>
                                            <th>Ngày kết thúc</th>
                                            <th colspan="3">Hành động</th>
                                        </tr>
                                        </thead>
                                        <tbody id="tableVoucher">
<!--                                        <tr th:each="voucher : ${pageVoucher}">-->
<!--                                            <td th:text="${voucher.codeVoucher}">Mã giảm giá</td>-->
<!--                                            <td th:text="${voucher.nameVoucher}">Tên giảm giá</td>-->
<!--                                            <td th:text="${voucher.priceReduced}">Giá trị giảm</td>-->
<!--                                            <td th:text="${voucher.quantity}">Số lượng</td>-->
<!--                                            <td th:text="${voucher.startDate}">Ngày bắt đầu</td>-->
<!--                                            <td th:text="${voucher.endDate}">Ngày kết thúc</td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/delete/{id}(id=${voucher.id})}"-->
<!--                                                   class="btn btn-danger btn-sm"-->
<!--                                                   onclick="return confirm('Bạn có muốn xóa phiếu giảm giá này không?')">Xóa</a>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/edit/{id}(id=${voucher.id})}"-->
<!--                                                   class="btn btn-warning btn-sm">Sửa</a>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/detail/{id}(id=${voucher.id})}"-->
<!--                                                   class="btn btn-primary btn-sm">Chi tiết</a>-->
<!--                                            </td>-->
<!--                                        </tr>-->
                                        </tbody>
                                    </table>
                                    <div class="pagination-section">
                                        <!-- Phân trang 2 -->
                                        <div class="pagination-custom d-flex justify-content-center">
                                            <ul id="maxPageVoucher-manageVoucher" class="pagination"></ul>
                                        </div>
                                    </div>
                                    <!-- Pagination for Active Table -->
<!--                                    <div class="text-center m-3">-->
<!--                                        <div class="d-flex justify-content-center">-->
<!--                                            <a th:href="@{/voucher/list?pageNumber=0}" class="btn btn-secondary mx-1">First</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumber=${pageVoucher.first ? 0 : pageVoucher.number - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Previous</a>-->
<!--                                            <div th:if="${pageVoucher.totalPages > 0}" class="d-flex">-->
<!--                                                <div th:each="pageNumber : ${#numbers.sequence(0, pageVoucher.totalPages - 1)}"-->
<!--                                                     class="mx-1">-->
<!--                                                    <a th:href="@{/voucher/list(pageNumber=${pageNumber})}"-->
<!--                                                       class="btn btn-primary" th:text="${pageNumber + 1}"></a>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                            <a th:href="@{/voucher/list(pageNumber=${pageVoucher.last ? pageVoucher.totalPages - 1 : pageVoucher.number + 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Next</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumber=${pageVoucher.totalPages - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Last</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>

                                <!-- Table 2: Ngừng Hoạt Động -->
<!--                                <div class="tab-pane fade" id="pills-inactive" role="tabpanel"-->
<!--                                     aria-labelledby="pills-inactive-tab">-->
<!--                                    <table class="table table-striped table-hover mt-3">-->
<!--                                        <thead class="bg-secondary text-white">-->
<!--                                        <tr>-->
<!--                                            <th>Mã</th>-->
<!--                                            <th>Tên</th>-->
<!--                                            <th>Giảm giá</th>-->
<!--                                            <th>Số lượng</th>-->
<!--                                            <th>Ngày bắt đầu</th>-->
<!--                                            <th>Ngày kết thúc</th>-->
<!--                                            <th colspan="2">Hành động</th>-->
<!--                                        </tr>-->
<!--                                        </thead>-->
<!--                                        <tbody>-->
<!--                                        <tr th:each="voucherdlt : ${pageVoucherDelete}">-->
<!--                                            <td th:text="${voucherdlt.codeVoucher}">Mã giảm giá</td>-->
<!--                                            <td th:text="${voucherdlt.nameVoucher}">Tên giảm giá</td>-->
<!--                                            <td th:text="${voucherdlt.priceReduced}">Giá trị giảm</td>-->
<!--                                            <td th:text="${voucherdlt.quantity}">Số lượng</td>-->
<!--                                            <td th:text="${voucherdlt.startDate}">Ngày bắt đầu</td>-->
<!--                                            <td th:text="${voucherdlt.endDate}">Ngày kết thúc</td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/restore/{id}(id=${voucherdlt.id})}"-->
<!--                                                   class="btn btn-success btn-sm"-->
<!--                                                   onclick="return confirm('Bạn có muốn khôi phục phiếu giảm giá này không?')">Khôi-->
<!--                                                    phục</a>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/detail/{id}(id=${voucherdlt.id})}"-->
<!--                                                   class="btn btn-primary btn-sm">Chi tiết</a>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        </tbody>-->
<!--                                    </table>-->
<!--                                    <div class="text-center m-3">-->
<!--                                        <div class="d-flex justify-content-center">-->
<!--                                            <a th:href="@{/voucher/list?pageNumberDelete=0}" class="btn btn-secondary mx-1">First</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumberDelete=${pageVoucherDelete.first ? 0 : pageVoucherDelete.number - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Previous</a>-->

<!--                                            <div th:if="${pageVoucherDelete.totalPages > 0}" class="d-flex">-->
<!--                                                <div th:each="pageNumber : ${#numbers.sequence(0, pageVoucherDelete.totalPages - 1)}"-->
<!--                                                     class="mx-1">-->
<!--                                                    <a th:href="@{/voucher/list(pageNumberDelete=${pageNumber})}"-->
<!--                                                       class="btn btn-primary" th:text="${pageNumber + 1}"></a>-->
<!--                                                </div>-->
<!--                                            </div>-->

<!--                                            <a th:href="@{/voucher/list(pageNumberDelete=${pageVoucherDelete.last ? pageVoucherDelete.totalPages - 1 : pageVoucherDelete.number + 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Next</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumberDelete=${pageVoucherDelete.totalPages - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Last</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->

                                <!-- Table 3: Hết Hạn -->
<!--                                <div class="tab-pane fade" id="pills-expired" role="tabpanel"-->
<!--                                     aria-labelledby="pills-expired-tab">-->
<!--                                    <table class="table table-striped table-hover mt-3">-->
<!--                                        <thead class="bg-danger text-white">-->
<!--                                        <tr>-->
<!--                                            <th>Mã</th>-->
<!--                                            <th>Tên</th>-->
<!--                                            <th>Giảm giá</th>-->
<!--                                            <th>Số lượng</th>-->
<!--                                            <th>Ngày bắt đầu</th>-->
<!--                                            <th>Ngày kết thúc</th>-->
<!--                                            <th colspan="2">Hành động</th>-->
<!--                                        </tr>-->
<!--                                        </thead>-->
<!--                                        <tbody>-->
<!--                                        <tr th:each="voucherExp : ${pageVoucherExpired}">-->
<!--                                            <td th:text="${voucherExp.codeVoucher}">Mã giảm giá</td>-->
<!--                                            <td th:text="${voucherExp.nameVoucher}">Tên giảm giá</td>-->
<!--                                            <td th:text="${voucherExp.priceReduced}">Giá trị giảm</td>-->
<!--                                            <td th:text="${voucherExp.quantity}">Số lượng</td>-->
<!--                                            <td th:text="${voucherExp.startDate}">Ngày bắt đầu</td>-->
<!--                                            <td th:text="${voucherExp.endDate}">Ngày kết thúc</td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/delete/{id}(id=${voucherExp.id})}"-->
<!--                                                   class="btn btn-danger btn-sm"-->
<!--                                                   onclick="return confirm('Bạn có muốn xóa phiếu giảm giá này không?')">Xóa</a>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <a th:href="@{/voucher/extend/{id}(id=${voucherExp.id})}"-->
<!--                                                   class="btn btn-success btn-sm"-->
<!--                                                   onclick="return confirm('Bạn có muốn gia hạn phiếu giảm giá này không?')">Gia-->
<!--                                                    hạn</a>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        </tbody>-->
<!--                                    </table>-->
<!--                                    <div class="text-center m-3">-->
<!--                                        <div class="d-flex justify-content-center">-->
<!--                                            <a th:href="@{/voucher/list(pageNumberExpired=0)}"-->
<!--                                               class="btn btn-secondary mx-1">First</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumberExpired=${pageVoucherExpired.first ? 0 : pageVoucherExpired.number - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Previous</a>-->

<!--                                            <div th:if="${pageVoucherExpired.totalPages > 0}" class="d-flex">-->
<!--                                                <div th:each="pageNumber : ${#numbers.sequence(0, pageVoucherExpired.totalPages - 1)}"-->
<!--                                                     class="mx-1">-->
<!--                                                    <a th:href="@{/voucher/list(pageNumberExpired=${pageNumber})}"-->
<!--                                                       class="btn btn-primary" th:text="${pageNumber + 1}"></a>-->
<!--                                                </div>-->
<!--                                            </div>-->

<!--                                            <a th:href="@{/voucher/list(pageNumberExpired=${pageVoucherExpired.last ? pageVoucherExpired.totalPages - 1 : pageVoucherExpired.number + 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Next</a>-->
<!--                                            <a th:href="@{/voucher/list(pageNumberExpired=${pageVoucherExpired.totalPages - 1})}"-->
<!--                                               class="btn btn-secondary mx-1">Last</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <input type="hidden" id="toastMessage" th:value="${message}">
    <input type="hidden" id="toastCheck" th:value="${check}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script th:src="@{/ajax/voucher/ajaxVoucher.js}" type="text/javascript"></script>
    <script th:src="@{/js/voucher/home.js}" type="text/javascript"></script>
    <script th:src="@{/js/voucher/search-type.js}" type="text/javascript"></script>
</div>
</body>
</html>
